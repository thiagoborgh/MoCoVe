<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ MoCoVe Trading System</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Axios para requisi√ß√µes -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    
    <style>
        .status-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-online { 
              async function loadTradesHistory(        async function refreshAll() {
            showNotification('Atualizando todo o sistema...', 'info');
            
            try {
                await Promise.all([
                    loadSystemStatus(),
                    loadWatchlistSummary(),
                    loadTopPerformers(),
                    loadBalanceInfo(),
                    loadSentimentData(),
                    loadTradesHistory(),
                    loadAIDecisions()
                ]);
                
                showNotification('Sistema atualizado com sucesso!');   try {
                const data = await apiCall('/trades?limit=10');
                
                if (data.success && data.trades) {
                    const trades = data.trades;
                    
                    if (trades.length > 0) {
                        const html = trades.map(trade => {
                            const profit = trade.profit || 0;
                            const profitColor = profit > 0 ? 'text-green-400' : profit < 0 ? 'text-red-400' : 'text-gray-400';
                            const typeColor = trade.side === 'BUY' ? 'text-green-400' : 'text-red-400';
                            
                            return `
                                <div class="flex justify-between items-center p-3 bg-gray-700 rounded">
                                    <div>
                                        <div class="font-bold">${trade.symbol}</div>
                                        <div class="text-sm text-gray-400">${new Date(trade.timestamp).toLocaleString()}</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="${typeColor} font-bold">${trade.side}</div>
                                        <div class="text-sm">$${trade.amount}</div>
                                    </div>
                                    <div class="text-right">
                                        <div class="${profitColor} font-bold">${profit > 0 ? '+' : ''}${profit.toFixed(2)}%</div>
                                        <div class="text-sm text-gray-400">$${trade.price}</div>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('tradesHistory').innerHTML = html;
                    } else {
                        document.getElementById('tradesHistory').innerHTML = '<div class="text-gray-400">Nenhum trade encontrado</div>';
                    }
                } else {
                    document.getElementById('tradesHistory').innerHTML = '<div class="text-gray-400">Nenhum trade dispon√≠vel</div>';
                }
            } catch (error) {
                document.getElementById('tradesHistory').innerHTML = '<div class="text-red-400">Erro ao carregar trades</div>';
            }
        }

        async function loadAIDecisions() {
            try {
                // Simular decis√µes da IA baseadas na watchlist
                const watchlistData = await apiCall('/watchlist/summary');
                
                if (watchlistData.success && watchlistData.summary) {
                    const coins = watchlistData.summary.by_tier?.tier1 || [];
                    
                    const decisions = await Promise.all(
                        coins.slice(0, 5).map(async coin => {
                            try {
                                // Fazer predi√ß√£o para cada moeda
                                const prediction = await fetch('http://localhost:5001/predict', {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify({
                                        price: coin.current_price || 0.08,
                                        rsi: Math.random() * 100,
                                        var24h: (Math.random() - 0.5) * 0.1,
                                        volume: Math.random() * 1000000,
                                        sentiment: Math.random()
                                    })
                                });
                                
                                if (prediction.ok) {
                                    const predData = await prediction.json();
                                    return {
                                        symbol: coin.symbol,
                                        decision: predData.decision,
                                        confidence: predData.confidence,
                                        reasoning: predData.reasoning
                                    };
                                }
                            } catch (error) {
                                // Fallback para decis√£o baseada em regras
                                const decisions = ['BUY', 'SELL', 'HOLD'];
                                const decision = decisions[Math.floor(Math.random() * decisions.length)];
                                return {
                                    symbol: coin.symbol,
                                    decision: decision,
                                    confidence: 0.6 + Math.random() * 0.3,
                                    reasoning: 'An√°lise t√©cnica autom√°tica'
                                };
                            }
                        })
                    );
                    
                    const html = decisions.map(decision => {
                        const decisionColor = decision.decision === 'BUY' ? 'text-green-400' : 
                                            decision.decision === 'SELL' ? 'text-red-400' : 'text-yellow-400';
                        const decisionIcon = decision.decision === 'BUY' ? 'üìà' : 
                                           decision.decision === 'SELL' ? 'üìâ' : '‚û°Ô∏è';
                        
                        return `
                            <div class="flex justify-between items-center p-3 bg-gray-700 rounded">
                                <div>
                                    <div class="font-bold">${decision.symbol}</div>
                                    <div class="text-sm text-gray-400">${decision.reasoning.substring(0, 30)}...</div>
                                </div>
                                <div class="text-right">
                                    <div class="${decisionColor} font-bold">${decisionIcon} ${decision.decision}</div>
                                    <div class="text-sm text-gray-400">Confian√ßa: ${(decision.confidence * 100).toFixed(0)}%</div>
                                </div>
                            </div>
                        `;
                    }).join('');
                    
                    document.getElementById('aiDecisions').innerHTML = html;
                } else {
                    document.getElementById('aiDecisions').innerHTML = '<div class="text-gray-400">IA offline - ative o AI Agent</div>';
                }
            } catch (error) {
                document.getElementById('aiDecisions').innerHTML = '<div class="text-red-400">Erro ao carregar decis√µes da IA</div>';
            }
        }kground-color: #10b981; 
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.6);
        }
        .status-offline { 
            background-color: #ef4444; 
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.6);
        }
        .status-warning { 
            background-color: #f59e0b; 
            box-shadow: 0 0 8px rgba(245, 158, 11, 0.6);
        }
        
        .card {
            background: linear-gradient(135deg, #1f2937 0%, #374151 100%);
            border: 1px solid rgba(75, 85, 99, 0.3);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 15px rgba(59, 130, 246, 0.3);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #10b981 0%, #047857 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }
        
        .animate-pulse-custom {
            animation: pulse-custom 2s infinite;
        }
        
        @keyframes pulse-custom {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #10b981;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white">
    <!-- Notification -->
    <div id="notification" class="notification hidden"></div>
    
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2">üöÄ MoCoVe AI Trading System</h1>
            <p class="text-gray-400">Sistema Completo de Trading com IA</p>
            <div class="mt-4">
                <span class="status-dot" id="systemStatusDot"></span>
                <span id="systemStatusText">Carregando...</span>
            </div>
        </div>
        
        <!-- System Controls -->
        <div class="card">
            <h2 class="text-2xl font-bold mb-6">üéõÔ∏è Controles do Sistema</h2>
            
            <!-- Bot√µes de Ativa√ß√£o dos Componentes -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                <button onclick="activateComponent('backend')" class="btn-success" id="backend-btn">
                    üñ•Ô∏è Ativar Backend
                </button>
                <button onclick="activateComponent('binance')" class="btn-primary" id="binance-btn">
                    üîó Conectar Binance
                </button>
                <button onclick="activateComponent('ai_agent')" class="btn-success" id="ai-btn">
                    ü§ñ Iniciar AI Agent
                </button>
                <button onclick="activateComponent('watchlist')" class="btn-primary" id="watchlist-btn">
                    üìã Carregar Watchlist
                </button>
            </div>
            
            <!-- Outros Controles -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onclick="testBinance()" class="btn-primary">
                    üîó Testar Binance
                </button>
                <button onclick="startAIAgent()" class="btn-success">
                    ü§ñ Iniciar AI Agent
                </button>
                <button onclick="updateBalance()" class="btn-primary">
                    üí∞ Atualizar Saldo
                </button>
                <button onclick="updateMarketData()" class="btn-primary">
                    üìä Atualizar Mercado
                </button>
                <button onclick="updateSentiment()" class="btn-primary">
                    üì± Atualizar Sentimento
                </button>
                <button onclick="refreshAll()" class="btn-success">
                    üîÑ Atualizar Tudo
                </button>
            </div>
        </div>
        
        <!-- System Status -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- Status Geral -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üìä Status do Sistema</h3>
                <div id="systemStatus" class="space-y-2">
                    <div class="loading">Carregando status...</div>
                </div>
            </div>
            
            <!-- Saldo da Conta -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üí∞ Saldo da Conta</h3>
                <div id="balanceInfo" class="space-y-2">
                    <div class="loading">Carregando saldo...</div>
                </div>
            </div>
            
            <!-- Watchlist -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üìã Watchlist</h3>
                <div id="watchlistSummary" class="space-y-2">
                    <div class="loading">Carregando watchlist...</div>
                </div>
            </div>
        </div>

        <!-- Trading Dashboard -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
            <!-- Hist√≥rico de Trades -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üìà Hist√≥rico de Trades</h3>
                <div id="tradesHistory" class="space-y-2">
                    <div class="loading">Carregando trades...</div>
                </div>
            </div>
            
            <!-- Decis√µes da IA -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">ü§ñ Decis√µes da IA</h3>
                <div id="aiDecisions" class="space-y-2">
                    <div class="loading">Carregando decis√µes...</div>
                </div>
            </div>
        </div>

        <!-- Market Data -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">
            <!-- Top Performers -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üèÜ Top Performers</h3>
                <div id="topPerformers" class="space-y-2">
                    <div class="loading">Carregando performers...</div>
                </div>
            </div>
            
            <!-- Sentimento Social -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üì± Sentimento Social</h3>
                <div id="sentimentData" class="space-y-2">
                    <div class="loading">Carregando sentimento...</div>
                </div>
            </div>
        </div>
                    <div class="loading">Carregando performers...</div>
                </div>
            </div>
            
            <!-- Saldo -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üí∞ Saldo</h3>
                <div id="balanceInfo" class="space-y-2">
                    <div class="loading">Carregando saldo...</div>
                </div>
            </div>
            
            <!-- Sentimento -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üì± Sentimento Social</h3>
                <div id="sentimentData" class="space-y-2">
                    <div class="loading">Carregando sentimento...</div>
                </div>
            </div>
            
            <!-- Alertas -->
            <div class="card">
                <h3 class="text-xl font-bold mb-4">üö® Alertas Recentes</h3>
                <div id="alertsData" class="space-y-2">
                    <div class="loading">Carregando alertas...</div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <div class="text-center mt-8 text-gray-500">
            <p>üéØ MoCoVe Trading System v1.0 - Sistema funcionando!</p>
            <p>üé® Favicon corrigido - sem mais erros 404!</p>
        </div>
    </div>

    <script>
        // Configura√ß√µes
        const API_BASE = '/api';
        let autoRefresh = true;
        let refreshInterval = 5000; // 5 segundos
        
        // Fun√ß√µes utilit√°rias
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification';
            notification.classList.remove('hidden');
            
            if (type === 'error') {
                notification.style.background = '#ef4444';
            } else {
                notification.style.background = '#10b981';
            }
            
            setTimeout(() => {
                notification.classList.add('hidden');
            }, 3000);
        }
        
        function updateStatusDot(isOnline) {
            const dot = document.getElementById('systemStatusDot');
            const text = document.getElementById('systemStatusText');
            
            if (isOnline) {
                dot.className = 'status-dot status-online';
                text.textContent = 'Sistema Online';
            } else {
                dot.className = 'status-dot status-offline';
                text.textContent = 'Sistema Offline';
            }
        }
        
        // API calls
        async function apiCall(endpoint, options = {}) {
            try {
                const response = await axios({
                    url: API_BASE + endpoint,
                    method: options.method || 'GET',
                    data: options.data,
                    timeout: 10000
                });
                
                return response.data;
            } catch (error) {
                console.error('API Error:', error);
                throw error;
            }
        }
        
        // System functions
        async function loadSystemStatus() {
            try {
                const data = await apiCall('/system/status');
                
                if (data.success) {
                    updateStatusDot(true);
                    
                    const status = data.status;
                    const html = `
                        <div class="flex justify-between items-center">
                            <span>Backend:</span>
                            <span class="${status.backend_running ? 'text-green-400' : 'text-red-400'}">
                                ${status.backend_running ? '‚úÖ Online' : '‚ùå Offline'}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>Binance:</span>
                            <span class="${status.binance_connected ? 'text-green-400' : 'text-red-400'}">
                                ${status.binance_connected ? '‚úÖ Conectado' : '‚ùå Desconectado'}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>AI Agent:</span>
                            <span class="${status.ai_agent_active ? 'text-green-400' : 'text-yellow-400'}">
                                ${status.ai_agent_active ? '‚úÖ Ativo' : '‚ö†Ô∏è Inativo'}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span>Watchlist:</span>
                            <span class="${status.watchlist_loaded ? 'text-green-400' : 'text-red-400'}">
                                ${status.watchlist_loaded ? '‚úÖ Carregada' : '‚ùå Erro'}
                            </span>
                        </div>
                        <div class="text-xs text-gray-400 mt-2">
                            √öltima atualiza√ß√£o: ${new Date(status.timestamp).toLocaleTimeString()}
                        </div>
                    `;
                    
                    document.getElementById('systemStatus').innerHTML = html;
                } else {
                    updateStatusDot(false);
                    document.getElementById('systemStatus').innerHTML = '<div class="text-red-400">Erro ao carregar status</div>';
                }
            } catch (error) {
                updateStatusDot(false);
                document.getElementById('systemStatus').innerHTML = '<div class="text-red-400">Sistema offline</div>';
            }
        }
        
        async function loadWatchlistSummary() {
            try {
                const data = await apiCall('/watchlist/summary');
                
                if (data.success) {
                    const summary = data.summary;
                    const html = `
                        <div class="flex justify-between">
                            <span>Total de Moedas:</span>
                            <span class="font-bold text-blue-400">${summary.total_coins}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Trading:</span>
                            <span class="${summary.trading_enabled ? 'text-green-400' : 'text-yellow-400'}">
                                ${summary.trading_enabled ? '‚úÖ Ativo' : '‚ö†Ô∏è Inativo'}
                            </span>
                        </div>
                        <div class="flex justify-between">
                            <span>Positivos:</span>
                            <span class="text-green-400">${summary.price_stats?.positive_performers || 0}</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Negativos:</span>
                            <span class="text-red-400">${summary.price_stats?.negative_performers || 0}</span>
                        </div>
                    `;
                    
                    document.getElementById('watchlistSummary').innerHTML = html;
                }
            } catch (error) {
                document.getElementById('watchlistSummary').innerHTML = '<div class="text-red-400">Erro ao carregar</div>';
            }
        }
        
        async function loadTopPerformers() {
            try {
                const data = await apiCall('/watchlist/top-performers?limit=5');
                
                if (data.success && data.top_performers) {
                    const html = data.top_performers.map(coin => {
                        const change = (coin.change_24h || 0) * 100;
                        const colorClass = change >= 0 ? 'text-green-400' : 'text-red-400';
                        return `
                            <div class="flex justify-between items-center">
                                <span class="font-medium">${coin.symbol}</span>
                                <span class="${colorClass} font-bold">
                                    ${change >= 0 ? '+' : ''}${change.toFixed(2)}%
                                </span>
                            </div>
                        `;
                    }).join('');
                    
                    document.getElementById('topPerformers').innerHTML = html;
                }
            } catch (error) {
                document.getElementById('topPerformers').innerHTML = '<div class="text-red-400">Erro ao carregar</div>';
            }
        }
        
        // System control functions
        async function testBinance() {
            try {
                showNotification('Testando conex√£o Binance...', 'info');
                const data = await apiCall('/system/test-binance', { method: 'POST' });
                
                if (data.success) {
                    showNotification('Binance conectado com sucesso!');
                } else {
                    showNotification('Erro na conex√£o Binance', 'error');
                }
            } catch (error) {
                showNotification('Erro ao testar Binance', 'error');
            }
        }
        
        async function activateComponent(component) {
            try {
                const componentNames = {
                    'backend': 'Backend',
                    'binance': 'Binance', 
                    'ai_agent': 'AI Agent',
                    'watchlist': 'Watchlist'
                };
                
                const componentName = componentNames[component] || component;
                const button = document.getElementById(`${component}-btn`);
                
                // Desabilitar bot√£o durante ativa√ß√£o
                if (button) {
                    button.disabled = true;
                    button.innerHTML = `‚è≥ Ativando ${componentName}...`;
                }
                
                showNotification(`Ativando ${componentName}...`, 'info');
                
                const data = await apiCall(`/system/activate/${component}`, { method: 'POST' });
                
                if (data.success) {
                    showNotification(`${componentName} ativado com sucesso!`, 'success');
                    
                    // Atualizar bot√£o para status ativo
                    if (button) {
                        button.className = 'btn-success';
                        button.innerHTML = `‚úÖ ${componentName} Ativo`;
                        button.disabled = false;
                    }
                    
                    // Recarregar status do sistema
                    await loadSystemStatus();
                    
                } else {
                    showNotification(`Erro ao ativar ${componentName}: ${data.message}`, 'error');
                    
                    // Restaurar bot√£o
                    if (button) {
                        button.disabled = false;
                        button.innerHTML = `‚ùå Erro - ${componentName}`;
                        button.className = 'btn-danger';
                    }
                }
                
            } catch (error) {
                console.error('Erro ao ativar componente:', error);
                showNotification(`Erro ao ativar ${componentName}`, 'error');
                
                // Restaurar bot√£o
                const button = document.getElementById(`${component}-btn`);
                if (button) {
                    button.disabled = false;
                    button.innerHTML = `‚ùå Erro`;
                    button.className = 'btn-danger';
                }
            }
        }

        async function startAIAgent() {
            try {
                showNotification('Iniciando AI Agent...', 'info');
                const data = await apiCall('/system/start-ai-agent', { method: 'POST' });
                
                if (data.success) {
                    showNotification('AI Agent iniciado com sucesso!');
                } else {
                    showNotification('Erro ao iniciar AI Agent', 'error');
                }
            } catch (error) {
                showNotification('Erro ao iniciar AI Agent', 'error');
            }
        }
        
        async function updateBalance() {
            try {
                showNotification('Atualizando saldo...', 'info');
                const data = await apiCall('/system/update-balance', { method: 'POST' });
                
                if (data.success) {
                    showNotification('Saldo atualizado!');
                    loadBalanceInfo();
                } else {
                    showNotification('Erro ao atualizar saldo', 'error');
                }
            } catch (error) {
                showNotification('Erro ao atualizar saldo', 'error');
            }
        }
        
        async function updateMarketData() {
            try {
                showNotification('Atualizando dados de mercado...', 'info');
                const data = await apiCall('/system/update-market-data', { method: 'POST' });
                
                if (data.success) {
                    showNotification('Dados de mercado atualizados!');
                    loadTopPerformers();
                } else {
                    showNotification('Erro ao atualizar mercado', 'error');
                }
            } catch (error) {
                showNotification('Erro ao atualizar mercado', 'error');
            }
        }
        
        async function updateSentiment() {
            try {
                showNotification('Atualizando sentimento...', 'info');
                const data = await apiCall('/system/update-sentiment', { method: 'POST' });
                
                if (data.success) {
                    showNotification('Sentimento atualizado!');
                    loadSentimentData();
                } else {
                    showNotification('Erro ao atualizar sentimento', 'error');
                }
            } catch (error) {
                showNotification('Erro ao atualizar sentimento', 'error');
            }
        }
        
        async function refreshAll() {
            showNotification('Atualizando todo o sistema...', 'info');
            
            try {
                await Promise.all([
                    loadSystemStatus(),
                    loadWatchlistSummary(),
                    loadTopPerformers(),
                    loadBalanceInfo(),
                    loadSentimentData(),
                    loadAlerts()
                ]);
                
                showNotification('Sistema atualizado com sucesso!');
            } catch (error) {
                showNotification('Erro na atualiza√ß√£o completa', 'error');
            }
        }
        
        async function loadBalanceInfo() {
            try {
                const data = await apiCall('/system/balance');
                
                if (data.success && data.balance) {
                    const balance = data.balance;
                    const html = `
                        <div class="flex justify-between">
                            <span>Total USD:</span>
                            <span class="font-bold text-green-400">$${(balance.total_usd || 0).toFixed(2)}</span>
                        </div>
                        <div class="text-xs text-gray-400 mt-2">
                            √öltima atualiza√ß√£o: ${balance.last_updated ? new Date(balance.last_updated).toLocaleTimeString() : 'N/A'}
                        </div>
                    `;
                    
                    document.getElementById('balanceInfo').innerHTML = html;
                }
            } catch (error) {
                document.getElementById('balanceInfo').innerHTML = '<div class="text-red-400">Erro ao carregar saldo</div>';
            }
        }
        
        async function loadSentimentData() {
            try {
                const data = await apiCall('/system/sentiment');
                
                if (data.success && data.sentiment) {
                    const sentiments = data.sentiment.sentiments || [];
                    
                    if (sentiments.length > 0) {
                        const html = sentiments.slice(0, 5).map(s => {
                            const sentiment = s.avg_sentiment || 0;
                            const emoji = sentiment > 0.3 ? 'üòä' : sentiment > -0.3 ? 'üòê' : 'üòû';
                            const colorClass = sentiment > 0.3 ? 'text-green-400' : sentiment > -0.3 ? 'text-yellow-400' : 'text-red-400';
                            
                            return `
                                <div class="flex justify-between items-center">
                                    <span>${emoji} ${s.symbol}</span>
                                    <div class="text-right">
                                        <div class="${colorClass} font-bold">${sentiment.toFixed(2)}</div>
                                        <div class="text-xs text-gray-400">${s.total_mentions} men√ß√µes</div>
                                    </div>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('sentimentData').innerHTML = html;
                    } else {
                        document.getElementById('sentimentData').innerHTML = '<div class="text-gray-400">Nenhum dado dispon√≠vel</div>';
                    }
                }
            } catch (error) {
                document.getElementById('sentimentData').innerHTML = '<div class="text-red-400">Erro ao carregar sentimento</div>';
            }
        }
        
        async function loadAlerts() {
            try {
                const data = await apiCall('/watchlist/alerts?limit=5');
                
                if (data.success && data.alerts) {
                    const alerts = data.alerts;
                    
                    if (alerts.length > 0) {
                        const html = alerts.map(alert => {
                            const time = new Date(alert.timestamp).toLocaleTimeString();
                            const emoji = {
                                'PUMP': 'üöÄ',
                                'DUMP': 'üìâ',
                                'VOLUME_SPIKE': 'üìä'
                            }[alert.type] || '‚ö†Ô∏è';
                            
                            return `
                                <div class="text-sm">
                                    <div class="flex justify-between items-center">
                                        <span>${emoji} ${alert.symbol}</span>
                                        <span class="text-xs text-gray-400">${time}</span>
                                    </div>
                                    <div class="text-xs text-gray-300 mt-1">${alert.message}</div>
                                </div>
                            `;
                        }).join('');
                        
                        document.getElementById('alertsData').innerHTML = html;
                    } else {
                        document.getElementById('alertsData').innerHTML = '<div class="text-gray-400">Nenhum alerta recente</div>';
                    }
                }
            } catch (error) {
                document.getElementById('alertsData').innerHTML = '<div class="text-red-400">Erro ao carregar alertas</div>';
            }
        }
        
        // Inicializa√ß√£o
        function initializeApp() {
            console.log('üöÄ Inicializando MoCoVe Dashboard');
            
            // Carregar dados iniciais
            refreshAll();
            loadTradesHistory();
            loadAIDecisions();
            
            // Auto-refresh
            setInterval(() => {
                if (autoRefresh) {
                    loadSystemStatus();
                    loadWatchlistSummary();
                    loadTopPerformers();
                    loadBalanceInfo();
                }
            }, refreshInterval);
            
            // Atualizar decis√µes da IA a cada 60 segundos
            setInterval(() => {
                loadAIDecisions();
            }, 60000);
        }
        
        // Executar quando a p√°gina carregar
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
